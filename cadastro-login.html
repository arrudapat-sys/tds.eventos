<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cadastro/Login - TDS Eventos</title>
<style>
body {
  font-family: Arial, sans-serif;
  background-color: #f5f5f5;
  margin: 0;
  padding: 20px;
}
h2 {
  color: #004aad;
}
form, #areaLogada {
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 0 8px rgba(0,0,0,0.1);
  margin-bottom: 30px;
}
label {
  display: block;
  margin-top: 10px;
}
input, button {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  border: 1px solid #ccc;
  border-radius: 5px;
}
button {
  background-color: #004aad;
  color: white;
  font-weight: bold;
  cursor: pointer;
  margin-top: 15px;
}
button:hover {
  background-color: #005eff;
}
.success-message {
  color: green;
  font-weight: bold;
  margin-top: 10px;
}
.error-message {
  color: red;
  font-weight: bold;
  margin-top: 10px;
}
.logout-btn {
  background-color: #c62828;
}
.logout-btn:hover {
  background-color: #ff5252;
}
</style>
</head>
<body>

<!-- √ÅREA DE CADASTRO -->
<div id="areaCadastro">
  <h2>Cadastro de Novo Usu√°rio</h2>
  <form id="cadastroForm">
    <label>Nome Completo:</label>
    <input type="text" id="nome" required>

    <label>Email:</label>
    <input type="email" id="email" required>

    <label>CPF:</label>
    <input type="text" id="cpf" placeholder="000.000.000-00" required>

    <label>Data de Nascimento:</label>
    <input type="date" id="dataNascimento" required>

    <label>Senha:</label>
    <input type="password" id="senha" required>

    <label>Confirme a Senha:</label>
    <input type="password" id="confirmarSenha" required>

    <button type="submit">Cadastrar Usu√°rio</button>
    <p id="mensagemCadastro"></p>
  </form>
</div>

<!-- √ÅREA DE LOGIN -->
<div id="areaLogin">
  <h2>Login</h2>
  <form id="loginForm">
    <label>Login (E-mail ou CPF):</label>
    <input type="text" id="login" required>

    <label>Senha:</label>
    <input type="password" id="senhaLogin" required>

    <button type="submit">Entrar</button>
    <p id="mensagemLogin"></p>
  </form>
</div>

<!-- √ÅREA DE RECUPERA√á√ÉO -->
<div id="areaRecuperar">
  <h2>Recuperar Senha</h2>
  <form id="recuperarForm">
    <label>E-mail ou CPF:</label>
    <input type="text" id="recLogin" required>

    <label>Data de Nascimento:</label>
    <input type="date" id="recData" required>

    <button type="submit">Recuperar Senha</button>
    <p id="mensagemRecuperar"></p>
  </form>
</div>

<!-- √ÅREA LOGADA -->
<div id="areaLogada" style="display:none;">
  <h2>Bem-vindo(a)!</h2>
  <p id="boasVindas"></p>
  <button id="logoutBtn" class="logout-btn">Sair da Conta</button>
</div>

<script>
// Fun√ß√µes utilit√°rias de armazenamento
function getUsuarios() {
  const data = localStorage.getItem("usuariosTDS");
  return data ? JSON.parse(data) : [];
}

function setUsuarios(usuarios) {
  localStorage.setItem("usuariosTDS", JSON.stringify(usuarios));
}

function getUsuarioLogado() {
  const data = localStorage.getItem("usuarioLogadoTDS");
  return data ? JSON.parse(data) : null;
}

function setUsuarioLogado(usuario) {
  localStorage.setItem("usuarioLogadoTDS", JSON.stringify(usuario));
}

function logoutUsuario() {
  localStorage.removeItem("usuarioLogadoTDS");
  mostrarTelaLogin();
}

// ===================== CADASTRO =====================
document.getElementById("cadastroForm").addEventListener("submit", function(event) {
  event.preventDefault();

  const nome = document.getElementById("nome").value.trim();
  const email = document.getElementById("email").value.trim();
  const cpf = document.getElementById("cpf").value.trim();
  const dataNascimento = document.getElementById("dataNascimento").value;
  const senha = document.getElementById("senha").value;
  const confirmarSenha = document.getElementById("confirmarSenha").value;
  const mensagem = document.getElementById("mensagemCadastro");

  if (senha !== confirmarSenha) {
    mensagem.textContent = "‚ùå As senhas n√£o conferem!";
    mensagem.className = "error-message";
    return;
  }

  let usuarios = getUsuarios();

  // Verifica duplicidade
  const jaExiste = usuarios.some(u => u.email === email || u.cpf === cpf);
  if (jaExiste) {
    mensagem.textContent = "‚ö†Ô∏è J√° existe um usu√°rio com esse e-mail ou CPF.";
    mensagem.className = "error-message";
    return;
  }

  usuarios.push({ nome, email, cpf, dataNascimento, senha });
  setUsuarios(usuarios);

  mensagem.textContent = "‚úÖ Cadastro realizado com sucesso!";
  mensagem.className = "success-message";
  document.getElementById("cadastroForm").reset();
});

// ===================== LOGIN =====================
document.getElementById("loginForm").addEventListener("submit", function(event) {
  event.preventDefault();

  const login = document.getElementById("login").value.trim();
  const senha = document.getElementById("senhaLogin").value;
  const mensagem = document.getElementById("mensagemLogin");

  const usuarios = getUsuarios();
  const usuario = usuarios.find(u => (u.email === login || u.cpf === login) && u.senha === senha);

  if (usuario) {
    setUsuarioLogado(usuario);
    mostrarTelaLogada(usuario);
  } else {
    mensagem.textContent = "‚ùå Login ou senha incorretos.";
    mensagem.className = "error-message";
  }
});

// ===================== RECUPERAR SENHA =====================
document.getElementById("recuperarForm").addEventListener("submit", function(event) {
  event.preventDefault();

  const login = document.getElementById("recLogin").value.trim();
  const data = document.getElementById("recData").value;
  const mensagem = document.getElementById("mensagemRecuperar");

  const usuarios = getUsuarios();
  const usuario = usuarios.find(u => (u.email === login || u.cpf === login) && u.dataNascimento === data);

  if (usuario) {
    mensagem.textContent = `üîê Recupera√ß√£o de senha: sua senha √© "${usuario.senha}".`;
    mensagem.className = "success-message";
  } else {
    mensagem.textContent = "‚ùå Dados n√£o conferem. Verifique e tente novamente.";
    mensagem.className = "error-message";
  }
});

// ===================== LOGOUT =====================
document.getElementById("logoutBtn").addEventListener("click", logoutUsuario);

// ===================== TROCA DE TELAS =====================
function mostrarTelaLogada(usuario) {
  document.getElementById("areaCadastro").style.display = "none";
  document.getElementById("areaLogin").style.display = "none";
  document.getElementById("areaRecuperar").style.display = "none";
  document.getElementById("areaLogada").style.display = "block";

  document.getElementById("boasVindas").textContent = `Ol√°, ${usuario.nome}! Voc√™ est√° logado com o e-mail ${usuario.email}.`;
}

function mostrarTelaLogin() {
  document.getElementById("areaCadastro").style.display = "block";
  document.getElementById("areaLogin").style.display = "block";
  document.getElementById("areaRecuperar").style.display = "block";
  document.getElementById("areaLogada").style.display = "none";
}

// ===================== AUTOLOGIN SE EXISTIR =====================
window.addEventListener("load", function() {
  const usuario = getUsuarioLogado();
  if (usuario) {
    mostrarTelaLogada(usuario);
  } else {
    mostrarTelaLogin();
  }
});
</script>
</body>
</html>